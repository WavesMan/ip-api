ADDR=:8080
UI_DIST=ui/dist
API_BASE=/api

PG_HOST=localhost
PG_PORT=5432
PG_USER=postgres
PG_PASSWORD=postgres
PG_DB=ipapi
PG_SSLMODE=disable
PG_MAX_OPEN_CONNS=50
PG_MAX_IDLE_CONNS=25

REDIS_HOST=127.0.0.1
REDIS_PORT=6379
REDIS_PASS=
REDIS_DB=0

# 缓存与去重窗口（秒）
CACHE_TTL_SECONDS=600
DEDUP_TTL_SECONDS=600

LOG_LEVEL=info
LOG_FORMAT=text

# 数据刷新（数据库导入）
# 已废弃：仅使用本地 IPIP 数据源初始化写库
AUTO_REPAIR_DB=true
IMPORT_IPIP_TO_DB=false

# IPIP 本地数据源路径
IPIP_PATH=data/ipip/ipipfree.ipdb
IPIP_WORKERS=8

# 高德 REST API（后端调用）
AMAP_SERVER_KEY=
AMAP_RATE_LIMIT_PER_MIN=120
AMAP_RETRY_MAX=2
AMAP_WORKERS=4
AMAP_INPUT_FILE=
AMAP_WRITE_EXACT=false
AMAP_ASSOC_KEY=amap

# 数据库候选源配置
AMAP_SOURCE=db
AMAP_DB_HOURS=24
AMAP_DB_LIMIT=1000

# 指标与限流
RATE_LIMIT_ENABLED=false
RATE_LIMIT_QPS=200

# 融合权重（0-10），可按月度纠错率调整
FUSION_WEIGHT_KV=10
FUSION_WEIGHT_IPIP=5
FUSION_WEIGHT_AMAP=8
FUSION_WEIGHT_IP2R=5

# 不完整命中触发融合与最小分阈值
ENABLE_FUSION_ON_PARTIAL_CACHE=true
ENABLE_FUSION_ON_PARTIAL_DB=false
FUSION_MIN_SCORE_ON_CACHE=20

# 额外 env 路径（按需）
# 后端将额外尝试加载 data/env/.env

# CIDR 构建与回滚配置
CIDR_SOURCE_TAG=amap-202512-cityfix
CIDR_MIN_LEN=8
CIDR_SOURCE_PREFIX=amap
CIDR_KEEP_N=10

# IP2Region v4 数据源路径（仅 v4，v6 暂不启用）
IP2REGION_V4_PATH=./data/ip2region/ip2region_v4.xdb

# # 管理令牌（用于 /api/reload 重建本地缓存）[废弃]
# ADMIN_TOKEN=
# TLS（默认启用，使用自签证书；在非 443 端口提供 HTTPS 并拒绝 HTTP）
TLS_ENABLE=true
TLS_CERT_PATH=data/certs/server.crt
TLS_KEY_PATH=data/certs/server.key
TLS_REDIRECT_ENABLE=false
TLS_REDIRECT_ADDR=:80

# 源站防御（仅允许 EdgeOne 回源网段与指定调试IP访问源站）
ORIGIN_DEFENSE_ENABLE=false
ORIGIN_ALLOW_IPS=127.0.0.1
ORIGIN_ALLOW_CIDRS=
ORIGIN_ALLOW_LOCAL=true
ORIGIN_REAL_IP_HEADER=

# TEO 回源网段轮询（需腾讯云 APIv3 凭证）
TEO_ENABLE=false
TC_SECRET_ID=
TC_SECRET_KEY=
TEO_ZONE_ID=
TEO_REGION=
TEO_POLL_SECONDS=259200
